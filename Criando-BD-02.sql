--CRIANDO A TABELA USUÁRIO

CREATE TABLE USUARIO
(
ID               INT IDENTITY,
LOGIN            VARCHAR(20) NOT NULL,
SENHA            VARCHAR(20) NOT NULL,
DTEXPIRACAO      DATE DEFAULT '19000101' NOT NULL,

CONSTRAINT PK_ID_USUARIO PRIMARY KEY (ID),
CONSTRAINT UQ_LOGIN	     UNIQUE (LOGIN)
);


INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('PEDRO','123ABC','2021-05-02')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('JOAO','123ABC','2021-05-02')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('TIAGO','123ABC','2021-05-03')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('JOSE','123ABC','2021-06-04')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('ARTUR','123ABC','2021-06-05')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('ROBERTO','123ABC','2021-06-06')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('VANESSA','123ABC','2021-07-07')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('MARIA','123ABC','2021-07-08')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('BIANCA','123ABC','2021-07-09')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('JOAQUIM','123ABC','2021-08-10')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('LUCIA','123ABC','2021-08-11')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('ANA','123ABC','2021-08-12')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('LIA','123ABC','2021-09-13')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('DAVI','123ABC','2021-09-14')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('SAMUEL','123ABC','2021-09-15')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('CAROL','123ABC','2021-10-16')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('CAIO','123ABC','2021-10-17')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('DENIS','123ABC','2021-10-18')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('MARIELA','123ABC','2021-11-19')
INSERT INTO USUARIO (LOGIN, SENHA, DTEXPIRACAO) VALUES ('EMMA','123ABC','2021-11-20')



--CRIANDO A TABELA COORDENADOR

CREATE TABLE COORDENADOR

(
ID           TINYINT IDENTITY,
ID_USUARIO   INT          NOT NULL,
NOME         VARCHAR(150) NOT NULL,
EMAIL        VARCHAR(50)  NOT NULL, 
CELULAR      CHAR(14)     NOT NULL, -- +55 11 00000 0000

CONSTRAINT PK_ID_COORDENADOR        PRIMARY KEY(ID),
CONSTRAINT UQ_EMAIL_COORDENADOR     UNIQUE(EMAIL),
CONSTRAINT UQ_CELULAR_COORDENADOR   UNIQUE(CELULAR),
CONSTRAINT FK_USUARIO_COORDENADOR   FOREIGN KEY (ID_USUARIO) REFERENCES USUARIO(ID)
);

INSERT INTO COORDENADOR (ID_USUARIO, NOME, EMAIL, CELULAR) VALUES (1,'PEDRO PUERTA','PEDROPUERTA@EMAIL.COM','11987654321')
INSERT INTO COORDENADOR (ID_USUARIO, NOME, EMAIL, CELULAR) VALUES (2,'JOÃO DANIEL','JOÃODANIEL@EMAIL.COM','11987651234')
INSERT INTO COORDENADOR (ID_USUARIO, NOME, EMAIL, CELULAR) VALUES (3,'TIAGO NEVES','TIAGONEVES@EMAIL.COM','11987651243')
INSERT INTO COORDENADOR (ID_USUARIO, NOME, EMAIL, CELULAR) VALUES (4,'JOSÉ PERALTA','JOSEPERALTA@EMAIL.COM','11987654312')
INSERT INTO COORDENADOR (ID_USUARIO, NOME, EMAIL, CELULAR) VALUES (5,'ARTUR SANTIAGO','ARTURSANTIAGO@EMAIL.COM','11987652431')



--CRIANDO A TABELA ALUNO

CREATE TABLE ALUNO

(
ID           INT IDENTITY,
ID_USUARIO   INT          NOT NULL,
NOME         VARCHAR(150) NOT NULL,
EMAIL        VARCHAR(50)  NOT NULL,
CELULAR      VARCHAR(14)  NOT NULL,
RA           VARCHAR(7)   NOT NULL,
FOTO         VARCHAR(200) NULL,

CONSTRAINT PK_ID_ALUNO          PRIMARY KEY(ID),
CONSTRAINT UQ_EMAIL_ALUNO       UNIQUE(EMAIL),
CONSTRAINT UQ_CELULAR_ALUNO     UNIQUE(CELULAR),
CONSTRAINT FK_USUARIO_ALUNO     FOREIGN KEY (ID_USUARIO) REFERENCES USUARIO(ID)
);


INSERT INTO ALUNO (ID_USUARIO, NOME, EMAIL, CELULAR, RA) VALUES (11,'LÚCIA SANTOS','LUCIASANTOS@EMAIL.COM','11987641003','1902653')
INSERT INTO ALUNO (ID_USUARIO, NOME, EMAIL, CELULAR, RA) VALUES (12,'ANA FLÁVIA','ANAFLAVIA@EMAIL.COM','11987641011','1902667')
INSERT INTO ALUNO (ID_USUARIO, NOME, EMAIL, CELULAR, RA) VALUES (13,'LIA REIS','LIAREIS@EMAIL.COM','11987641019','1902681')
INSERT INTO ALUNO (ID_USUARIO, NOME, EMAIL, CELULAR, RA) VALUES (14,'DAVI SILVA','DAVISILVA@EMAIL.COM','11987641027','1902695')
INSERT INTO ALUNO (ID_USUARIO, NOME, EMAIL, CELULAR, RA) VALUES (15,'SAMUEL DIEGO','SAMUELDIEGO@EMAIL.COM','11987641035','1902709')
INSERT INTO ALUNO (ID_USUARIO, NOME, EMAIL, CELULAR, RA) VALUES (16,'CAROL RET','CAROLRET@EMAIL.COM','11987641043','1902723')
INSERT INTO ALUNO (ID_USUARIO, NOME, EMAIL, CELULAR, RA) VALUES (17,'CAIO JORGE','CAIOJORGE@EMAIL.COM','11987641051','1902737')
INSERT INTO ALUNO (ID_USUARIO, NOME, EMAIL, CELULAR, RA) VALUES (18,'DÊNIS FERNANDES','DENISFERNANDES@EMAIL.COM','11987641059','1902751')
INSERT INTO ALUNO (ID_USUARIO, NOME, EMAIL, CELULAR, RA) VALUES (19,'MARIELA AMATO','MARIELAAMATO@EMAIL.COM','11987641067','1902765')
INSERT INTO ALUNO (ID_USUARIO, NOME, EMAIL, CELULAR, RA) VALUES (20,'EMMA ROCHA','EMMAROCHA@EMAIL.COM','11987641075','1902779')


--CRIANDO A TABELA PROFESSOR

CREATE TABLE PROFESSOR

(
ID          SMALLINT IDENTITY,
ID_USUARIO  INT         NOT NULL,
EMAIL       VARCHAR(50) NOT NULL,
CELULAR     VARCHAR(14) NOT NULL,
APELIDO     VARCHAR(20) NOT NULL,

CONSTRAINT PK_ID_PROFESSOR		 PRIMARY KEY(ID),
CONSTRAINT UQ_EMAIL_PROFESSOR	 UNIQUE(EMAIL),
CONSTRAINT UQ_CELULAR_PROFESSOR	 UNIQUE(CELULAR),
CONSTRAINT FK_USUARIO_PROFESSOR	 FOREIGN KEY(ID_USUARIO) REFERENCES USUARIO(ID)
);

INSERT INTO PROFESSOR (ID_USUARIO, EMAIL, CELULAR, APELIDO) VALUES (6,'ROBERTOGOES@EMAIL.COM','11987452564','ROBERTO GOES')
INSERT INTO PROFESSOR (ID_USUARIO, EMAIL, CELULAR, APELIDO) VALUES (7,'VANESSADAMATA@EMAIL.COM','11987452689','VANESSA DAMATA')
INSERT INTO PROFESSOR (ID_USUARIO, EMAIL, CELULAR, APELIDO) VALUES (8,'MARIATAVARES@EMAIL.COM','11987452814','MARIA TAVARES')
INSERT INTO PROFESSOR (ID_USUARIO, EMAIL, CELULAR, APELIDO) VALUES (9,'BIANCACAMPAGNARO@EMAIL.COM','11987452939','BIANCA CAMPAGNARO')
INSERT INTO PROFESSOR (ID_USUARIO, EMAIL, CELULAR, APELIDO) VALUES (10,'JOAQUIMSAVIO@EMAIL.COM','11987453064','JOAQUIM SAVIO')


--CRIANDO A TABELA DISCIPLINA

CREATE TABLE DISCIPLINA

(
ID                        SMALLINT IDENTITY,   
NOME                      VARCHAR(150) NOT NULL,
DATA                      DATETIME     DEFAULT GETDATE(),
STATUS                    VARCHAR(7)   DEFAULT 'ABERTA',
PLANODEENSINO             VARCHAR(MAX) NOT NULL,
CARGAHORARIA              TINYINT      NOT NULL, 
COMPETENCIAS              VARCHAR(MAX) NOT NULL,
HABILIDADES               VARCHAR(MAX) NOT NULL,
EMENTA                    VARCHAR(MAX) NOT NULL,
CONTEUDOPROGRAMATICO      VARCHAR(MAX) NOT NULL,
BIBLIOGRAFIABASICA        VARCHAR(MAX) NOT NULL,
BIBLIOGRAFIACOMPLEMENTAR  VARCHAR(MAX) NOT NULL,
PERCENTUALPRATICO         TINYINT      NOT NULL, 
PERCENTUALTEORICO         TINYINT      NOT NULL,
IDCOORDENADOR             TINYINT     NOT NULL, 

CONSTRAINT PK_ID_DISCPLINA       PRIMARY KEY(ID),
CONSTRAINT UQ_NOME		         UNIQUE(NOME),
CONSTRAINT CK_STATUS_DISCIPLINA  CHECK(STATUS = 'ABERTA' OR STATUS = 'FECHADA'),
CONSTRAINT CK_CARGAHORARIA       CHECK(CARGAHORARIA = 40 OR CARGAHORARIA = 80),
CONSTRAINT CK_PERCENTUALPRATICO  CHECK(PERCENTUALPRATICO BETWEEN 0 AND 100),
CONSTRAINT CK_PERCENTUALTEORICO  CHECK(PERCENTUALTEORICO BETWEEN 0 AND 100),
CONSTRAINT FK_COORDENADOR_DISCIPLINA FOREIGN KEY (IDCOORDENADOR) REFERENCES COORDENADOR(ID) 
);

INSERT INTO DISCIPLINA (NOME, PLANODEENSINO, CARGAHORARIA, COMPETENCIAS, HABILIDADES, EMENTA, CONTEUDOPROGRAMATICO, BIBLIOGRAFIABASICA, BIBLIOGRAFIACOMPLEMENTAR, PERCENTUALPRATICO, PERCENTUALTEORICO, IDCOORDENADOR) VALUES ('WEB DESENVOLVIMENTO','PLANO DE ENSINO...',40,'COMPETÊNCIAS...','HABILIDADES...','EMENTA...','CONTEÚDO...','BIBLIO. BASICA...','BIBLIO. COMPLEMENTAR...',60,40,1)
INSERT INTO DISCIPLINA (NOME, PLANODEENSINO, CARGAHORARIA, COMPETENCIAS, HABILIDADES, EMENTA, CONTEUDOPROGRAMATICO, BIBLIOGRAFIABASICA, BIBLIOGRAFIACOMPLEMENTAR, PERCENTUALPRATICO, PERCENTUALTEORICO, IDCOORDENADOR) VALUES ('AMBIENTES OPERACIONAIS','PLANO DE ENSINO...',40,'COMPETÊNCIAS...','HABILIDADES...','EMENTA...','CONTEÚDO...','BIBLIO. BASICA...','BIBLIO. COMPLEMENTAR...',70,30,2)
INSERT INTO DISCIPLINA (NOME, PLANODEENSINO, CARGAHORARIA, COMPETENCIAS, HABILIDADES, EMENTA, CONTEUDOPROGRAMATICO, BIBLIOGRAFIABASICA, BIBLIOGRAFIACOMPLEMENTAR, PERCENTUALPRATICO, PERCENTUALTEORICO, IDCOORDENADOR) VALUES ('PROGRAMAÇÃO','PLANO DE ENSINO...',80,'COMPETÊNCIAS...','HABILIDADES...','EMENTA...','CONTEÚDO...','BIBLIO. BASICA...','BIBLIO. COMPLEMENTAR...',80,20,3)
INSERT INTO DISCIPLINA (NOME, PLANODEENSINO, CARGAHORARIA, COMPETENCIAS, HABILIDADES, EMENTA, CONTEUDOPROGRAMATICO, BIBLIOGRAFIABASICA, BIBLIOGRAFIACOMPLEMENTAR, PERCENTUALPRATICO, PERCENTUALTEORICO, IDCOORDENADOR) VALUES ('SQL','PLANO DE ENSINO...',80,'COMPETÊNCIAS...','HABILIDADES...','EMENTA...','CONTEÚDO...','BIBLIO. BASICA...','BIBLIO. COMPLEMENTAR...',50,50,4)
INSERT INTO DISCIPLINA (NOME, PLANODEENSINO, CARGAHORARIA, COMPETENCIAS, HABILIDADES, EMENTA, CONTEUDOPROGRAMATICO, BIBLIOGRAFIABASICA, BIBLIOGRAFIACOMPLEMENTAR, PERCENTUALPRATICO, PERCENTUALTEORICO, IDCOORDENADOR) VALUES ('ENGENHARIA DE SOFTWARE','PLANO DE ENSINO...',80,'COMPETÊNCIAS...','HABILIDADES...','EMENTA...','CONTEÚDO...','BIBLIO. BASICA...','BIBLIO. COMPLEMENTAR...',50,50,5)

--CRIANDO A TABELA CURSO

CREATE TABLE CURSO
(
ID   TINYINT IDENTITY,
NOME VARCHAR(150) NOT NULL,

CONSTRAINT PK_ID_CURSO    PRIMARY KEY(ID),
CONSTRAINT UQ_NOME_CURSO  UNIQUE(NOME)
);

INSERT INTO CURSO (NOME) VALUES ('SISTEMAS DE INFORMAÇÃO')

--CRIANDO A TABELA DISCIPLINAOFERTADA

CREATE TABLE DISCIPLINAOFERTADA
(
ID                 SMALLINT IDENTITY, 
IDCOORDENADOR      TINYINT  NOT NULL, 
DTINICIOMATRICULA  DATE     NULL,
DTFIMMATRICULA     DATE     NULL,
IDDISCIPLINA       SMALLINT NOT NULL, 
IDCURSO            TINYINT  NOT NULL, 
ANO                SMALLINT NOT NULL, 
SEMESTRE           CHAR(1)  NOT NULL,
TURMA              CHAR(1)  NOT NULL,
IDPROFESSOR        SMALLINT     NULL,
METODOLOGIA        VARCHAR(MAX) NULL,
RECURSOS           VARCHAR(MAX) NULL,
CRITERIOAVALIACAO  VARCHAR(MAX) NULL,
PLANODEAULAS       VARCHAR(MAX) NULL,

CONSTRAINT PK_ID_DISCIPLINAOFERTADA            PRIMARY KEY(ID),
CONSTRAINT CK_ANO                              CHECK ( ANO BETWEEN 1900 AND 2100),
CONSTRAINT CK_SEMESTRE                         CHECK(SEMESTRE = 1 OR SEMESTRE = 2),
CONSTRAINT CK_TURMA                            CHECK(TURMA IN ('A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z') ),
CONSTRAINT FK_IDCOORDENADOR_DISCIPLINAOFERTADA FOREIGN KEY (IDCOORDENADOR) REFERENCES COORDENADOR(ID),
CONSTRAINT FK_IDDISCIPLINA_DISCIPLINAOFERTADA  FOREIGN KEY (IDDISCIPLINA) REFERENCES DISCIPLINA(ID),
CONSTRAINT FK_IDCURSO_DISCIPLINAOFERTADA       FOREIGN KEY (IDCURSO) REFERENCES CURSO(ID),
CONSTRAINT FK_IDPROFESSOR_DISCIPLINAOFERTADA   FOREIGN KEY (IDPROFESSOR) REFERENCES PROFESSOR(ID),
CONSTRAINT UQ_DISCIPLINA                       UNIQUE(IDDISCIPLINA, IDCURSO, ANO, SEMESTRE, TURMA),
);

INSERT INTO DISCIPLINAOFERTADA (IDCOORDENADOR, IDDISCIPLINA, IDCURSO, ANO, SEMESTRE, TURMA, IDPROFESSOR) VALUES (1,1,1,1900,1,'A',1)
INSERT INTO DISCIPLINAOFERTADA (IDCOORDENADOR, IDDISCIPLINA, IDCURSO, ANO, SEMESTRE, TURMA, IDPROFESSOR) VALUES (2,2,1,2100,2,'B',2)
INSERT INTO DISCIPLINAOFERTADA (IDCOORDENADOR, IDDISCIPLINA, IDCURSO, ANO, SEMESTRE, TURMA, IDPROFESSOR) VALUES (3,3,1,1910,1,'C',3)
INSERT INTO DISCIPLINAOFERTADA (IDCOORDENADOR, IDDISCIPLINA, IDCURSO, ANO, SEMESTRE, TURMA, IDPROFESSOR) VALUES (4,4,1,1948,2,'D',4)
INSERT INTO DISCIPLINAOFERTADA (IDCOORDENADOR, IDDISCIPLINA, IDCURSO, ANO, SEMESTRE, TURMA, IDPROFESSOR) VALUES (5,5,1,2000,1,'E',5)




-- CRIANDO A TABELA SOLICITACAOMATRICULA

CREATE TABLE SOLICITACAOMATRICULA
(
ID                    INT IDENTITY,       
IDALUNO               INT       NOT NULL, 
IDDISCIPLINAOFERTADA  SMALLINT  NOT NULL, 
DTSOLICITACAO         DATETIME DEFAULT GETDATE(),
IDCOORDENADOR         TINYINT NULL,
STATUS                VARCHAR(10) DEFAULT 'SOLICITADA',

CONSTRAINT PK_ID_SOLICITACAOMATRICULA        PRIMARY KEY(ID),
CONSTRAINT CK_STATUS_SOLICITACAOMATRICULA    CHECK(STATUS = 'SOLICITADA' OR STATUS = 'APROVADA' OR STATUS = 'CANCELADA'),
CONSTRAINT FK_ALUNO_SOLICITACAOMATRICULA     FOREIGN KEY (IDALUNO) REFERENCES ALUNO (ID),
CONSTRAINT FK_DISCIPLINAOFERTADA_SOLICITACAOMATRICULA FOREIGN KEY (IDDISCIPLINAOFERTADA) REFERENCES DISCIPLINAOFERTADA (ID), 
CONSTRAINT FK_COORDENADOR_SOLICITACAOMATRICULA        FOREIGN KEY (IDCOORDENADOR) REFERENCES COORDENADOR(ID)
);


INSERT INTO SOLICITACAOMATRICULA (IDALUNO, IDDISCIPLINAOFERTADA, IDCOORDENADOR) VALUES (1,1,1)
INSERT INTO SOLICITACAOMATRICULA (IDALUNO, IDDISCIPLINAOFERTADA, IDCOORDENADOR) VALUES (2,2,1)
INSERT INTO SOLICITACAOMATRICULA (IDALUNO, IDDISCIPLINAOFERTADA, IDCOORDENADOR) VALUES (3,3,2)
INSERT INTO SOLICITACAOMATRICULA (IDALUNO, IDDISCIPLINAOFERTADA, IDCOORDENADOR) VALUES (4,4,2)
INSERT INTO SOLICITACAOMATRICULA (IDALUNO, IDDISCIPLINAOFERTADA, IDCOORDENADOR) VALUES (5,5,3)
INSERT INTO SOLICITACAOMATRICULA (IDALUNO, IDDISCIPLINAOFERTADA, IDCOORDENADOR) VALUES (6,1,3)
INSERT INTO SOLICITACAOMATRICULA (IDALUNO, IDDISCIPLINAOFERTADA, IDCOORDENADOR) VALUES (7,2,4)
INSERT INTO SOLICITACAOMATRICULA (IDALUNO, IDDISCIPLINAOFERTADA, IDCOORDENADOR) VALUES (8,3,4)
INSERT INTO SOLICITACAOMATRICULA (IDALUNO, IDDISCIPLINAOFERTADA, IDCOORDENADOR) VALUES (9,4,5)
INSERT INTO SOLICITACAOMATRICULA (IDALUNO, IDDISCIPLINAOFERTADA, IDCOORDENADOR) VALUES (10,5,5)


-- CRIANDO A TABELA ATIVIDADE

CREATE TABLE ATIVIDADE
(
ID            SMALLINT IDENTITY, 
TITULO        VARCHAR(50)  NOT NULL, 
DESCRICAO     VARCHAR(MAX) NULL , 
CONTEUDO      VARCHAR(MAX) NOT NULL, 
TIPO          VARCHAR(15)  NOT NULL,
EXTRAS        VARCHAR(200) NULL,
IDPROFRESSOR  SMALLINT     NOT NULL,

CONSTRAINT PK_ID_ATIVIDADE            PRIMARY KEY(ID),
CONSTRAINT UQ_TITULO	              UNIQUE(TITULO),
CONSTRAINT CK_TIPO                    CHECK(TIPO = 'RESPOSTA ABERTA' OR TIPO = 'TESTE'),
CONSTRAINT FK_IDPROFRESSOR_ATIVIDADE  FOREIGN KEY (IDPROFRESSOR) REFERENCES PROFESSOR(ID)
);

INSERT INTO ATIVIDADE (TITULO, CONTEUDO, TIPO, IDPROFRESSOR) VALUES ('TÍTULO 2','CONTEÚDO...','TESTE', 2)
INSERT INTO ATIVIDADE (TITULO, CONTEUDO, TIPO, IDPROFRESSOR) VALUES ('TÍTULO 3','CONTEÚDO...','RESPOSTA ABERTA',3)
INSERT INTO ATIVIDADE (TITULO, CONTEUDO, TIPO, IDPROFRESSOR) VALUES ('TÍTULO 4','CONTEÚDO...','TESTE',4)
INSERT INTO ATIVIDADE (TITULO, CONTEUDO, TIPO, IDPROFRESSOR) VALUES ('TÍTULO 5','CONTEÚDO...','RESPOSTA ABERTA',5)
INSERT INTO ATIVIDADE (TITULO, CONTEUDO, TIPO, IDPROFRESSOR) VALUES ('TÍTULO 6','CONTEÚDO...','TESTE',1)
INSERT INTO ATIVIDADE (TITULO, CONTEUDO, TIPO, IDPROFRESSOR) VALUES ('TÍTULO 7','CONTEÚDO...','RESPOSTA ABERTA',2)
INSERT INTO ATIVIDADE (TITULO, CONTEUDO, TIPO, IDPROFRESSOR) VALUES ('TÍTULO 8','CONTEÚDO...','TESTE',3)
INSERT INTO ATIVIDADE (TITULO, CONTEUDO, TIPO, IDPROFRESSOR) VALUES ('TÍTULO 9','CONTEÚDO...','RESPOSTA ABERTA',4)
INSERT INTO ATIVIDADE (TITULO, CONTEUDO, TIPO, IDPROFRESSOR) VALUES ('TÍTULO 10','CONTEÚDO...','TESTE',5)


-- CRIANDO A TABELA ATIVIDADEVINCULADA

CREATE TABLE ATIVIDADEVINCULADA
(
ID                    SMALLINT IDENTITY, 
IDATIVIDADE           SMALLINT   NOT NULL,
IDPROFESSOR           SMALLINT   NOT NULL,
IDDISCIPLINAOFERTADA  SMALLINT   NOT NULL,
ROTULO                VARCHAR(3) NOT NULL,
STATUS                VARCHAR(15)NOT NULL,
DTINICIORESPOSTAS     DATE       NOT NULL,
DTFIMRESPOSTAS        DATE       NOT NULL,

CONSTRAINT PK_ID_ATIVIDADEVINCULADA                  PRIMARY KEY (ID),
CONSTRAINT FK_ATIVIDADE_ATIVIDADEVINCULADA           FOREIGN KEY (IDATIVIDADE) REFERENCES ATIVIDADE (ID),
CONSTRAINT FK_PROFESSOR_ATIVIDADEVINCULADA           FOREIGN KEY (IDPROFESSOR) REFERENCES PROFESSOR (ID),
CONSTRAINT FK_DISCIPLINAOFERTADA_ATIVIDADEVINCULADA  FOREIGN KEY (IDDISCIPLINAOFERTADA) REFERENCES DISCIPLINAOFERTADA (ID),
CONSTRAINT CK_STATUS_ATIVIDADEVINCULADA              CHECK (STATUS = 'DISPONIBILIZADA' OR STATUS = 'ABERTA' OR STATUS = 'FECHADA' OR STATUS = 'PRORROGADA' OR STATUS = 'ENCERRADA'),
CONSTRAINT CK_ROTULO                                 CHECK (ROTULO IN ('AC1', 'AC2','AC3', 'AC4', 'AC5','PAI','SUB')),
CONSTRAINT UQ_ROTULO                                 UNIQUE(IDATIVIDADE, IDDISCIPLINAOFERTADA, ROTULO)
);

INSERT INTO ATIVIDADEVINCULADA (IDATIVIDADE, IDPROFESSOR, IDDISCIPLINAOFERTADA, ROTULO, STATUS, DTINICIORESPOSTAS, DTFIMRESPOSTAS) VALUES (2,1,5,'AC1','DISPONIBILIZADA','2021-04-11','2021-04-25')
INSERT INTO ATIVIDADEVINCULADA (IDATIVIDADE, IDPROFESSOR, IDDISCIPLINAOFERTADA, ROTULO, STATUS, DTINICIORESPOSTAS, DTFIMRESPOSTAS) VALUES (4,2,4,'AC2','ABERTA','2021-04-11','2021-04-25')
INSERT INTO ATIVIDADEVINCULADA (IDATIVIDADE, IDPROFESSOR, IDDISCIPLINAOFERTADA, ROTULO, STATUS, DTINICIORESPOSTAS, DTFIMRESPOSTAS) VALUES (6,3,3,'AC3','ENCERRADA','2021-04-11','2021-04-25')
INSERT INTO ATIVIDADEVINCULADA (IDATIVIDADE, IDPROFESSOR, IDDISCIPLINAOFERTADA, ROTULO, STATUS, DTINICIORESPOSTAS, DTFIMRESPOSTAS) VALUES (8,4,2,'AC4','PRORROGADA','2021-04-11','2021-04-25')
INSERT INTO ATIVIDADEVINCULADA (IDATIVIDADE, IDPROFESSOR, IDDISCIPLINAOFERTADA, ROTULO, STATUS, DTINICIORESPOSTAS, DTFIMRESPOSTAS) VALUES (9,5,1,'AC5','FECHADA','2021-04-11','2021-04-25')



-- CRIANDO A TABELA ENTREGA

CREATE TABLE ENTREGA
(
ID                    INT IDENTITY, 
IDALUNO               INT         NOT NULL, 
IDATIVIDADEVINCULADA  SMALLINT    NOT NULL, 
TITULO                VARCHAR(50) NOT NULL, 
RESPOSTA              VARCHAR(MAX)NOT NULL, 
DTENTREGA             DATETIME     DEFAULT GETDATE() NOT NULL,
STATUS                VARCHAR(9)   DEFAULT 'ENTREGUE',
IDPROFESSOR           SMALLINT     NULL,
NOTA                  DECIMAL(4,2) NULL,
DTAVALIACAO           DATE         NULL,
OBS                   VARCHAR(MAX) NULL,

CONSTRAINT PK_ID_ENTREGA                   PRIMARY KEY(ID),
CONSTRAINT CK_STATUS                       CHECK(STATUS = 'ENTREGUE' OR STATUS = 'CORRIGIDO'),
CONSTRAINT CK_NOTA                         CHECK(NOTA BETWEEN 0.00 AND 10.00),
CONSTRAINT FK_IDALUNO_ENTREGA              FOREIGN KEY (IDALUNO) REFERENCES ALUNO(ID),
CONSTRAINT FK_IDATIVIDADEVINCULADA_ENTREGA FOREIGN KEY (IDATIVIDADEVINCULADA) REFERENCES ATIVIDADEVINCULADA (ID),
CONSTRAINT FK_IDPROFESSOR_ENTREGA          FOREIGN KEY (IDPROFESSOR) REFERENCES PROFESSOR(ID),
CONSTRAINT UQ_ALUNO                        UNIQUE(IDALUNO,IDATIVIDADEVINCULADA)
);

INSERT INTO ENTREGA (IDALUNO, IDATIVIDADEVINCULADA, TITULO, RESPOSTA, NOTA) VALUES (2,1,'TÍTULO...','RESPOSTA...',10.00)
INSERT INTO ENTREGA (IDALUNO, IDATIVIDADEVINCULADA, TITULO, RESPOSTA, NOTA) VALUES (4,2,'TÍTULO...','RESPOSTA...',9.00)
INSERT INTO ENTREGA (IDALUNO, IDATIVIDADEVINCULADA, TITULO, RESPOSTA, NOTA) VALUES (6,3,'TÍTULO...','RESPOSTA...',8.00)
INSERT INTO ENTREGA (IDALUNO, IDATIVIDADEVINCULADA, TITULO, RESPOSTA, NOTA) VALUES (8,4,'TÍTULO...','RESPOSTA...',7.00)
INSERT INTO ENTREGA (IDALUNO, IDATIVIDADEVINCULADA, TITULO, RESPOSTA, NOTA) VALUES (10,4,'TÍTULO...','RESPOSTA...',6.00)



-- CRIANDO A TABELA MENSAGEM

CREATE TABLE MENSAGEM
(
ID           INT IDENTITY, 
IDALUNO      INT NOT NULL,
IDPROFESSOR  SMALLINT NOT NULL,
ASSUNTO      VARCHAR(MAX) NOT NULL,
REFERENCIA   VARCHAR(MAX) NOT NULL,
CONTEUDO     VARCHAR(MAX) NOT NULL,
STATUS       VARCHAR(10) DEFAULT 'LIDO' NOT NULL,
DTENVIO      DATE DEFAULT GETDATE() NOT NULL,
DTRESPOSTA   DATE  NULL ,
RESPOSTA     VARCHAR(MAX) NULL,

CONSTRAINT PK_ID_MENSAGEM          PRIMARY KEY (ID), 
CONSTRAINT FK_IDALUNO_MENSAGEM     FOREIGN KEY (IDALUNO) REFERENCES ALUNO(ID),
CONSTRAINT FK_IDPROFESSOR_MENSAGEM FOREIGN KEY (IDPROFESSOR) REFERENCES PROFESSOR(ID),
CONSTRAINT CK_STATUS_MENSAGEM      CHECK(STATUS = 'ENVIADO' OR STATUS = 'LIDO' OR STATUS = 'RESPONDIDO'),
);

INSERT INTO MENSAGEM (IDALUNO, IDPROFESSOR, ASSUNTO, REFERENCIA, CONTEUDO) VALUES (1,5,'ASSUNTO...','REFERÊNCIA...','CONTEÚDO...')
INSERT INTO MENSAGEM (IDALUNO, IDPROFESSOR, ASSUNTO, REFERENCIA, CONTEUDO) VALUES (3,4,'ASSUNTO...','REFERÊNCIA...','CONTEÚDO...')
INSERT INTO MENSAGEM (IDALUNO, IDPROFESSOR, ASSUNTO, REFERENCIA, CONTEUDO) VALUES (5,3,'ASSUNTO...','REFERÊNCIA...','CONTEÚDO...')
INSERT INTO MENSAGEM (IDALUNO, IDPROFESSOR, ASSUNTO, REFERENCIA, CONTEUDO) VALUES (7,2,'ASSUNTO...','REFERÊNCIA...','CONTEÚDO...')
INSERT INTO MENSAGEM (IDALUNO, IDPROFESSOR, ASSUNTO, REFERENCIA, CONTEUDO) VALUES (9,1,'ASSUNTO...','REFERÊNCIA...','CONTEÚDO...')
